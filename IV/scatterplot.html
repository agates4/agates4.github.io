<!DOCTYPE html>
<html lang="en">

<style>

svg {
font: 10px sans-serif;
padding: 10px;
}

.axis,
.frame {
shape-rendering: crispEdges;
}

.axis line {
stroke: #ddd;
}

.axis path {
display: none;
}

.cell text {
font-weight: bold;
text-transform: capitalize;
}

.frame {
fill: none;
stroke: #aaa;
}

circle {
fill-opacity: .7;
}

circle.hidden {
fill: #ccc !important;
}

.extent {
fill: #000;
fill-opacity: .125;
stroke: #fff;
}

</style>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Information Visualization Project - Spring 2018</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Leaflet Map Style -->
    <link href="css/leaflet.css" rel="stylesheet" />
    <link href="css/leaflet.draw.css" rel="stylesheet" />
    <!-- Your Style -->
    <link href="css/MyCSS.css" rel="stylesheet">
    <!-- Leaflet Map api -->
    <script src="js/leaflet-src.js"></script>
    <script src="js/Leaflet.draw.js"></script>

    <script src="js/edit/handler/Edit.Poly.js"></script>
    <script src="js/edit/handler/Edit.SimpleShape.js"></script>
    <script src="js/edit/handler/Edit.Circle.js"></script>
    <script src="js/edit/handler/Edit.Rectangle.js"></script>

    <script src="js/draw/handler/Draw.Feature.js"></script>
    <script src="js/draw/handler/Draw.Polyline.js"></script>
    <script src="js/draw/handler/Draw.Polygon.js"></script>
    <script src="js/draw/handler/Draw.SimpleShape.js"></script>
    <script src="js/draw/handler/Draw.Rectangle.js"></script>
    <script src="js/draw/handler/Draw.Circle.js"></script>
    <script src="js/draw/handler/Draw.Marker.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="js/d3.layout.cloud.js"></script>
    <link rel="stylesheet" type="text/css" href="../style.css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script src="js/ext/LatLngUtil.js"></script>
    <script src="js/ext/GeometryUtil.js"></script>
    <script src="js/ext/LineUtil.Intersect.js"></script>
    <script src="js/ext/Polyline.Intersect.js"></script>
    <script src="js/ext/Polygon.Intersect.js"></script>

    <script src="js/Control.Draw.js"></script>
    <script src="js/Tooltip.js"></script>
    <script src="js/Toolbar.js"></script>

    <script src="js/draw/DrawToolbar.js"></script>
    <script src="js/edit/EditToolbar.js"></script>
    <script src="js/edit/handler/EditToolbar.Edit.js"></script>
    <script src="js/edit/handler/EditToolbar.Delete.js"></script>
    <script src="js/communist.js"></script>
    <script src="js/TArr.js"></script>
    <script src="../D3Scripts/scatterPlot.js"></script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <!-- Your js File -->
    <!-- <script src="js/Myjs.js"></script> -->
</head>

<body>


</body>

<script>
    var width = 960,
        size = 230,
        padding = 20;

    var x = d3.scale.linear()
        .range([padding / 2, size - padding / 2]);

    var y = d3.scale.linear()
        .range([size - padding / 2, padding / 2]);

    var xAxis = d3.svg.axis()
        .scale(x)
        .orient("top")
        .ticks(6);

    var yAxis = d3.svg.axis()
        .scale(y)
        .orient("right")
        .ticks(6);

    var color = d3.scale.category10();
    console.log(color)

    d3.json("https://raw.githubusercontent.com/agates4/agates4.github.io/master/IV/js/trips.json", function(error, fullData) {
        var data = [];
        for (var key in fullData.features) {
            data.push({
                speed: fullData.features[key].properties.avspeed,
                distance: fullData.features[key].properties.distance,
                duration: fullData.features[key].properties.duration
            });
        }

        var domainTrait = {},
            allAtrributes = d3.keys(data[0]),
            n = allAtrributes.length;

        allAtrributes.forEach(function(trait) {
            domainTrait[trait] = d3.extent(data, function(d) {
                return d[trait];
            });
        });

        xAxis.tickSize(size * n);
        yAxis.tickSize(-size * n);

        var svg = d3.select("body").append("svg")
            .attr("width", size * n + padding)
            .attr("height", size * n + padding)
            .append("g")
            .attr("transform", "translate(" + padding + "," + padding / 2 + ")");

        svg.selectAll(".x.axis")
            .data(allAtrributes)
            .enter().append("g")
            .attr("class", "x axis")
            .attr("transform", function(d, i) {
                return "translate(" + (n - i - 1) * size + ",0)";
            })
            .each(function(d) {
                x.domain(domainTrait[d]);
                d3.select(this).call(xAxis);
            });

        svg.selectAll(".y.axis")
            .data(allAtrributes)
            .enter().append("g")
            .attr("class", "y axis")
            .attr("transform", function(d, i) {
                return "translate(0," + i * size + ")";
            })
            .each(function(d) {
                y.domain(domainTrait[d]);
                d3.select(this).call(yAxis);
            });

        var cell = svg.selectAll(".cell")
            .data(cross(allAtrributes, allAtrributes))
            .enter().append("g")
            .attr("class", "cell")
            .attr("transform", function(d) {
                return "translate(" + (n - d.i - 1) * size + "," + d.j * size + ")";
            })
            .each(plot);

        function plot(p) {
            var cell = d3.select(this);

            x.domain(domainTrait[p.x]);
            y.domain(domainTrait[p.y]);

            cell.append("rect")
                .attr("class", "frame")
                .attr("width", size - padding)
                .attr("height", size - padding)
                .attr("x", padding / 2)
                .attr("y", padding / 2);
            cell.selectAll("circle")
                .data(data)
                .enter().append("circle")
                .attr("cx", function(d) {
                    return x(d[p.x]);
                })
                .attr("cy", function(d) {
                    return y(d[p.y]);
                })
                .attr("r", 4)
                .style("fill", function(d) {
                    return color(d.duration);
                }).on("click", function(d){
                    alert("Distance = " + Math.round(d.distance) + "\n" +
                    "Speed = " + Math.round(d.speed) + "\n" +
                    "Duration = " + Math.round(d.duration) + "\n")
                })
        }
    });

    function cross(a, b) {
        var c = [],
            n = a.length,
            m = b.length,
            i, j;
        for (i = -1; ++i < n;)
            for (j = -1; ++j < m;) c.push({
                x: a[i],
                i: i,
                y: b[j],
                j: j
            });
        return c;
    }
</script>

</html>